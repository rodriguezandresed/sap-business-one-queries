SELECT 

CASE 
WHEN QUOTE.RUTA  IS NULL  THEN INVOICE.RUTA
ELSE QUOTE.RUTA
END AS 'Ruta de Ventas',

CASE 
WHEN QUOTE.NOMBRE  IS NULL  THEN INVOICE.NOMBRE
ELSE QUOTE.NOMBRE
END AS 'Nombre del Cliente',

 CASE 
WHEN QUOTE.CATEGORIA IS NULL THEN INVOICE.CATEGORIA
ELSE QUOTE.CATEGORIA
END AS 'Categoria del Cliente'

FROM 


(SELECT DISTINCT T0.[U_ORN_RUTAS_VENTAS] AS "RUTA", T0.[CardName]'NOMBRE', 


 CASE 
WHEN T1.[GroupCode]=100 THEN 'CADENA SUPERMERCADO'
WHEN T1.[GroupCode]=101 THEN 'MATERIA PRIMA'
WHEN T1.[GroupCode]=102 THEN 'PTES PIEZAS Y REPUES'
WHEN T1.[GroupCode]=103 THEN 'SERVICIOS'
WHEN T1.[GroupCode]=104 THEN 'SERVICIOS PERSONAL'
WHEN T1.[GroupCode]=105 THEN 'SERVICIOS/PIEZAS/REP'
WHEN T1.[GroupCode]=106 THEN 'DISTRIBUIDOR'
WHEN T1.[GroupCode]=107 THEN 'INSTITUCIONAL'
WHEN T1.[GroupCode]=108 THEN 'MAYORISTA'
WHEN T1.[GroupCode]=109 THEN 'RESTAURANT'
WHEN T1.[GroupCode]=110 THEN 'SUPERMERCADO INDEPENDIENTE'
WHEN T1.[GroupCode]=111 THEN 'EMPLEADOS'
WHEN T1.[GroupCode]=112 THEN 'ACCIONISTA'
WHEN T1.[GroupCode]=113 THEN 'ESPECIAL'
WHEN T1.[GroupCode]=114 THEN 'COMIDA/VIVERES'
WHEN T1.[GroupCode]=115 THEN 'ARTICULOS DE OFICINA'
WHEN T1.[GroupCode]=116 THEN 'TRANSPORTE'
END AS 'CATEGORIA'

FROM OQUT T0  INNER JOIN OCRD T1 ON T0.[CardCode] = T1.[CardCode] INNER JOIN QUT1 T2 ON T0.[DocEntry] = T2.[DocEntry] WHERE (T0.[DocDate] BETWEEN [%0] AND [%1]) AND (T0."CANCELED" = 'N') AND (T0."DocStatus" = 'O' ) AND T2.[Quantity] > 0 and T0.[U_ORN_RUTAS_VENTAS] = [%2]  GROUP BY T0.[CardName], T1.[GroupCode], T0.[U_ORN_RUTAS_VENTAS] ) AS QUOTE



FULL OUTER JOIN 




( SELECT DISTINCT T0.[U_ORN_RUTAS_VENTAS] AS "RUTA", T0.[CardName]'NOMBRE',  CASE 
WHEN T1.[GroupCode]=100 THEN 'CADENA SUPERMERCADO'
WHEN T1.[GroupCode]=101 THEN 'MATERIA PRIMA'
WHEN T1.[GroupCode]=102 THEN 'PTES PIEZAS Y REPUES'
WHEN T1.[GroupCode]=103 THEN 'SERVICIOS'
WHEN T1.[GroupCode]=104 THEN 'SERVICIOS PERSONAL'
WHEN T1.[GroupCode]=105 THEN 'SERVICIOS/PIEZAS/REP'
WHEN T1.[GroupCode]=106 THEN 'DISTRIBUIDOR'
WHEN T1.[GroupCode]=107 THEN 'INSTITUCIONAL'
WHEN T1.[GroupCode]=108 THEN 'MAYORISTA'
WHEN T1.[GroupCode]=109 THEN 'RESTAURANT'
WHEN T1.[GroupCode]=110 THEN 'SUPERMERCADO INDEPENDIENTE'
WHEN T1.[GroupCode]=111 THEN 'EMPLEADOS'
WHEN T1.[GroupCode]=112 THEN 'ACCIONISTA'
WHEN T1.[GroupCode]=113 THEN 'ESPECIAL'
WHEN T1.[GroupCode]=114 THEN 'COMIDA/VIVERES'
WHEN T1.[GroupCode]=115 THEN 'ARTICULOS DE OFICINA'
WHEN T1.[GroupCode]=116 THEN 'TRANSPORTE'
END AS 'CATEGORIA'
FROM OINV T0  INNER JOIN OCRD T1 ON T0.[CardCode] = T1.[CardCode] INNER JOIN INV1 T2 ON T0.[DocEntry] = T2.[DocEntry] 
WHERE T0.[DocDate] BETWEEN [%0] AND [%1] AND T2.[Quantity] >0  and T0.[U_ORN_RUTAS_VENTAS] = [%2]  
GROUP BY T0.[CardName], T1.[GroupCode], T0.[U_ORN_RUTAS_VENTAS] ) AS  INVOICE ON QUOTE.NOMBRE = INVOICE.NOMBRE
 

 
 
 
 
